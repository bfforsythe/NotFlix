<!-- Loop a function that adds continuous images based on how many urls they are
     the urls function as hyperlinks to an image, on click redirect to watchPage, easy. -->
<style>
    Body {
        background: rgb(45,160,184);
        background: linear-gradient( rgba(45,160,184,1) 2%, rgba(2,0,36,0.7792366946778712) 16%, rgba(9,115,121,1) 92%);
        }
        .slideshow-group {
        display: flex;
        justify-content: center;
        }
</style>

<%- include('./partials/carousel.ejs') %>

<body>

  <% if(user.accountType == "editor"){ %>
    <button>
        <a href="/upload">Upload</a>
    </button>
<% } %>

    <button>
        <a href="/"> Log Out!</a>
    </button>


    
    <div class="slideshow-container">
      <p1>Action</p1>
        <% for (let i = 0; i < newMovieGenres.Action.length; i += 4) { %>
          <div class="slideshow-group">
            <% for (let j = i; j < i + 4 && j < newMovieGenres.Action.length; j++) { %>
                <div class="mySlides fade">
                        <img height="100px" width="200px" src="https://i.ytimg.com/vi/<%= newMovieGenres.Action[j] %>/maxresdefault.jpg" onclick="storeURL('<%= newMovieGenres.Action[j] %>')">
                    </div>  
            <% } %>
          
        <% } %>
        <a class="prev" onclick="plusSlides(-1)">❮</a>
        <a class="next" onclick="plusSlides(1)">❯</a>
      </div>

      <!-- Horror Slides -->

      
      <div class="slideshow-container">
        <p1> Horror </p1>
        <% for (let i = 0; i < newMovieGenres.Horror.length; i += 4) { %>
          <div class="slideshow-group">
            <% for (let j = i; j < i + 4 && j < newMovieGenres.Horror.length; j++) { %>
                <div class="mySlides fade">
                        <img height="100px" width="200px" src="https://i.ytimg.com/vi/<%= newMovieGenres.Horror[j] %>/maxresdefault.jpg" onclick="storeURL('<%= newMovieGenres.Horror[j] %>')">
                    </div>  
            <% } %>
          
        <% } %>
        <a class="prev" onclick="plusSlides(-1)">❮</a>
        <a class="next" onclick="plusSlides(1)">❯</a>
      </div>


      <!-- Romance Slides -->

      
      <div class="slideshow-container">
        <p1> Romance </p1>
        <% for (let i = 0; i < newMovieGenres.Romance.length; i += 4) { %>
          <div class="slideshow-group">
            <% for (let j = i; j < i + 4 && j < newMovieGenres.Romance.length; j++) { %>
                <div class="mySlides fade">
                        <img height="100px" width="200px" src="https://i.ytimg.com/vi/<%= newMovieGenres.Romance[j] %>/maxresdefault.jpg" onclick="storeURL('<%= newMovieGenres.Romance[j] %>')">
                    </div>  
            <% } %>
          
        <% } %>
        <a class="prev" onclick="plusSlides(-1)">❮</a>
        <a class="next" onclick="plusSlides(1)">❯</a>
      </div>
      


</body>


<script>


function storeURL(url) {
    localStorage.setItem("retrievedURL", url);
    console.log("URL STORED!", url);
    const newUrl = `/watchPage/${url}`;
    window.location.href = newUrl;
}

let slideIndex = 1;
showSlides(slideIndex);

// Next/previous controls
function plusSlides(n) {
  showSlides(slideIndex += n);
}

// Thumbnail image controls
function currentSlide(n) {
  showSlides(slideIndex = n);
}

function showSlides(n) {
  let i;
  let slides = document.getElementsByClassName("mySlides");

  if (n > Math.ceil(slides.length/4)) {slideIndex = 1} // Calculates the total maximum number of "pages" (i'm so proud of this :^) )
  if (n < 1) {slideIndex = Math.ceil(slides.length/4)}
  for (i = 0; i < slides.length; i++) {
    slides[i].style.display = "none";
  }
  
  let start = (slideIndex-1)*4;
  let end = start+4;
  for (i = start; i < end && i < slides.length; i++) {
    slides[i].style.display = "block";
  }

  // hide remaining slides
  for (i = end; i < slides.length; i++) {
    slides[i].style.display = "none";
  }
}

</script>